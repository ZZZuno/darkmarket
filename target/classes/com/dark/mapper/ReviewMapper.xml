<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE mapper 
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dark.mapper.ReviewMapper">

<insert id="review_insert" parameterType="com.dark.domain.ReviewVO">

INSERT INTO REVIEW_TBL(rew_num, dark_id, item_num, rew_content, rew_score)
VALUES(SEQ_REVIEW_TBL.nextval, #{dark_id}, #{item_num}, #{rew_content}, #{rew_score})

</insert>

<update id="modify" parameterType="com.dark.domain.ReviewVO">

update review_tbl
set rew_content = #{rew_content}, rew_score = #{rew_score}
where rew_num = #{rew_num}

</update>

<select id="list" parameterType="map" resultType="com.dark.domain.ReviewVO">

<![CDATA[
		select 
    		ROWNUM RN, REW_NUM, DARK_ID, ITEM_NUM, REW_CONTENT, REW_SCORE, REW_REGDATE
		from 
		    (
		    select /*+INDEX_DESC(REVIEW_TBL PK_REVIEW_TBL) */
		        rownum rn, REW_NUM, DARK_ID, ITEM_NUM, REW_CONTENT, REW_SCORE, REW_REGDATE
		    from 
		        REVIEW_TBL
		    where 
		    	ITEM_NUM = #{item_num}
		      AND
		        rownum <= #{cri.pageNum} * #{cri.amount}
		    )
		where 
		    rn > (#{cri.pageNum} -1) * #{cri.amount}
		]]>

</select>

<select id="listCount" parameterType="Integer" resultType="int">

select count(*)
from review_tbl
where item_num = #{item_num}

</select>

<delete id="delete" parameterType="Long">

delete from
	review_tbl
where rew_num = #{rew_num}

</delete>

</mapper>